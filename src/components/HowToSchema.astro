---
// 可复用的 HowTo 结构化数据组件，适用于教程/指南类文章
// 用法示例：<HowToSchema 
//   name="如何……"
//   description="……"
//   steps={[{ name: "...", text: "...", image?: "..." }]}
//   totalTime="PT30M"
// />

interface HowToStep {
  name: string
  text: string
  image?: string
  url?: string
}

interface Props {
  name: string
  description: string
  steps: HowToStep[]
  totalTime?: string // ISO 8601 时长格式（例如：30 分钟为 "PT30M"）
  image?: string
}

const { name, description, steps, totalTime, image } = Astro.props

if (!steps || steps.length === 0) {
  return null
}

const howToSchema = {
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": name,
  "description": description,
  ...(image && {
    "image": image
  }),
  ...(totalTime && {
    "totalTime": totalTime
  }),
  "step": steps.map((step, index) => ({
    "@type": "HowToStep",
    "position": index + 1,
    "name": step.name,
    "text": step.text,
    ...(step.image && {
      "image": step.image
    }),
    ...(step.url && {
      "url": step.url
    })
  }))
}
---

<script type="application/ld+json" set:html={JSON.stringify(howToSchema)} />
